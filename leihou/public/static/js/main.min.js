(function(d){var g={isValid:false,answear_a_ok:false,answear_b_ok:false,modal_bug_text:"",hongbao_code:"",question_code:"",answear_a:"",answear_b:"",description_name:"",description_right:"",description_wrong:""};var b=(window.location.hash).replace(/#/g,"");c("modal-bug-text",200);c("hongbao-code",10);c("question-code",150);c("answear-a",20);c("answear-b",20);c("description-name",20);c("description-right",20);c("description-wrong",20);d(".modal-trigger").leanModal({dismissible:true,opacity:0.5,in_duration:50,out_duration:100,ready:function(){},complete:function(){}});d("#modal-bug-submit").click(function(l){if(!i("modal-bug-text",200)){return}d.ajax({url:"/hongbao/report",method:"POST",data:{data:d("#modal-bug-text").val()},success:function(){d("#modal-bug").closeModal()},error:function(m){alert("呃……服务器被我关了")}})});d("#send-hongbao").click(function(){var m=e();if(m!="#home"){window.location.hash=m;var l=d("<span class='green'>"+"先填写完整再发送哦"+"</span>");Materialize.toast(l,5000);return false}g["time"]=new Date().getTime();d.ajax({url:"/hongbao/set",method:"POST",data:g,success:function(n){window.location="/bao/"+n.location+".html#"+n.hash},error:function(n){alert("呃……服务器被我关了")}})});d("#show-me-ur-money-btn").click(function(){window.location.hash="#"+b;var l=d("#show-me-ur-money-btn").hasClass("locked")||(f("miss")==(window.location.hash).replace(/#/g,""));if(l){d("#show-me-ur-money-btn").html('<i class="icon-lock yellow darken-3"></i>');return}else{d("#money-trick").openModal()}});d("#hongbao-check-btn").click(function(m){clientData={clientHash:b};var l=d('input[type="radio"][name="answear"]:checked').val();if(l){clientData["clientRet"]=l}else{alert("请先点击，选择其中一个答案");return}d.ajax({url:"/hongbao/check",method:"POST",data:clientData,success:function(n){if(n.result=="ok"&&n.key==l){var o=d("<span class='green'>"+n.description_right+"</span>");Materialize.toast(o,5000);if(0>=d("#boxOpen").length){d("#hongbao-card-content").prepend('<br><p id="boxOpen">红包口令: '+n.box+"</p>");d("#show-me-ur-money-btn").html('<i class="icon-lock-open yellow darken-3"></i>')}}else{if(n.result=="ok"&&n.key!=l){var o=d("<span class='green'>"+n.description_wrong+"</span>");Materialize.toast(o,5000);j("miss",clientData.clientHash,3);d("#show-me-ur-money-btn").addClass("locked");d("#show-me-ur-money-btn").html('<i class="icon-lock yellow darken-3"></i>')}else{var o=d("<span class='green'>"+"呃……红包不是发你的？"+"</span>");Materialize.toast(o,5000)}}k()},error:function(n){alert("呃……服务器被我关了")}});d("#money-trick").closeModal()});d(".ripple-btn").click(a);function a(q){var p=q.target;if(p.tagName.toLowerCase()!=="div"){return}var m=p.getBoundingClientRect();var l=p.querySelector(".ripple");if(!l){l=document.createElement("span");l.className="ripple";l.style.height=l.style.width=Math.max(m.width,m.height)+"px";p.appendChild(l)}l.classList.remove("show");var o=q.pageY-m.top-l.offsetHeight/2-document.body.scrollTop;var n=q.pageX-m.left-l.offsetWidth/2-document.body.scrollLeft;l.style.top=o+"px";l.style.left=n+"px";l.classList.add("show");return false}function i(m,l){var n=d("#"+m).val();if(n.length<=l){return true}else{return false}}function c(o,l){var n=d("#"+o+"-warning");var m=d("#"+o);m.keyup(function(){var p=m.val().length;if(p>l){n.css("color","red");g[isValid]=false}else{g[o.replace(/-/g,"_")]=m.val()}n.text("已输入"+p+"/"+l)})}function e(){g["answear_a_ok"]=(true==d("#answear-a-right").prop("checked"))?true:false;g["answear_b_ok"]=(true==d("#answear-b-right").prop("checked"))?true:false;if(g["answear_a_ok"]||g["answear_b_ok"]){}else{g["answear_a_ok"]=(Math.random()>0.5);g["answear_b_ok"]=!g["answear_a_ok"]}for(var l in g){if("isValid"!=l&&"modal_bug_text"!=l&&g[l].length==0){var m="#"+l.replace(/_/g,"-");return m}}return"#home"}function j(n,o,p){if(p){var m=new Date();m.setTime(m.getTime()+(p*24*60*60*1000));var l="; expires="+m.toGMTString()}else{var l=""}document.cookie=n+"="+o+l+"; path=/"}function f(m){var o=m+"=";var l=document.cookie.split(";");for(var n=0;n<l.length;n++){var p=l[n];while(p.charAt(0)==" "){p=p.substring(1,p.length)}if(p.indexOf(o)==0){return p.substring(o.length,p.length)}}return null}function h(l){createCookie(l,"",-1)}function k(){if(0<d("#send-alson").length){d("#send-alson").addClass("shake");return}else{return}}})(jQuery);